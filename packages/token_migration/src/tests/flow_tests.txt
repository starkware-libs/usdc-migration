Basic flows
1. User swap threshold + x legacy, then swap x new back to legacy
2. User swap and fail (not enough balance), then contract gets more new tokens from reverse swap, swap again and succeed.
3. end to end: swaps, send to L1, swap and fail, get money, swap and aucceed
4. reverse swap and fail, gets money, reverse swap and succeed
5. swap without approve fail, swap without balance fail, then approve then swap
6. User just transfer money, then swap
7. user swap twice

Send to L1
1. Sends all legacy to L1 (function), then swap should fail

Set threshold
1. not send to L1 in set threshold if not needed
2. start with the large batch size, then change to the small batch size, check send to L1

Approve to owner
1. Withdraw all/part of legacy/new

Upgrade
1. some swaps, send to L1, upgrade, cant swap/do anything

Set allow new to legacy swap
1. Disable, check that legacy -> new still works.